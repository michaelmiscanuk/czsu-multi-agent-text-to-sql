<mxfile host="65bd71144e">
    <diagram id="main-execution-flow" name="Main Execution Flow">
        <mxGraphModel dx="656" dy="901" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="1654" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="title" value="LangGraph Multi-Agent Execution Flow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="280" y="20" width="600" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="start" value="Function Entry" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="480" y="80" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="phase1-label" value="PHASE 1: INITIALIZATION" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#0066CC;" parent="1" vertex="1">
                    <mxGeometry x="40" y="170" width="280" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="step1" value="Resolve Input Parameters&#xa;(prompt, thread_id, run_id)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="170" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step2" value="Establish Memory Baseline&#xa;(track RSS memory usage)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="250" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step3" value="Initialize Checkpointer&#xa;(PostgreSQL or InMemory fallback)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="330" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step4" value="Create LangGraph Workflow&#xa;(17 nodes across 6 stages)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="410" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="phase2-label" value="PHASE 2: STATE PREPARATION" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#0066CC;" parent="1" vertex="1">
                    <mxGeometry x="40" y="500" width="280" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="step5" value="Check Existing Conversation State&#xa;(query checkpointer for messages)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="500" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="decision1" value="Existing&#xa;conversation?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="490" y="590" width="180" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step6a" value="New Conversation:&#xa;Initialize complete state&#xa;(13 fields + follow-up prompts)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="240" y="720" width="220" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="step6b" value="Continuing Conversation:&#xa;Reset iteration fields&#xa;(preserve message history)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="700" y="720" width="220" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="merge1" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;strokeColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="570" y="830" width="20" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="phase3-label" value="PHASE 3: LANGGRAPH EXECUTION" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#CC0000;" parent="1" vertex="1">
                    <mxGeometry x="40" y="890" width="320" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="execution" value="Execute LangGraph Workflow&#xa;(graph.ainvoke)&#xa;&#xa;• Query Rewriting&#xa;• Parallel Retrieval (DB + PDF)&#xa;• SQL Generation (MCP tools)&#xa;• Self-Correction Loop&#xa;• Answer Synthesis" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=13;fontStyle=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="400" y="890" width="360" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="phase4-label" value="PHASE 4: POST-EXECUTION MONITORING" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#0066CC;" parent="1" vertex="1">
                    <mxGeometry x="40" y="1070" width="380" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="step7" value="Monitor Memory Growth&#xa;(compare before/after RSS)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="1070" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="decision2" value="Memory growth&#xa;&gt; threshold?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="490" y="1160" width="180" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step8" value="Emergency Cleanup&#xa;(force garbage collection)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="800" y="1180" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="merge2" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;strokeColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="570" y="1290" width="20" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="phase5-label" value="PHASE 5: RESULT PROCESSING" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#0066CC;" parent="1" vertex="1">
                    <mxGeometry x="40" y="1340" width="300" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="step9" value="Extract Key Results&#xa;(answer, SQL queries, datasets)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="1340" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step10" value="Filter Used Dataset Codes&#xa;(parse SQL for table names)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="1420" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step11" value="Serialize PDF Chunks&#xa;(Document to JSON format)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="1500" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="phase6-label" value="PHASE 6: FINAL CLEANUP" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#0066CC;" parent="1" vertex="1">
                    <mxGeometry x="40" y="1590" width="240" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="step12" value="Final Garbage Collection&#xa;(release temporary resources)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="1590" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step13" value="Log Memory Statistics&#xa;(total growth &amp; diagnostics)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="440" y="1670" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="end" value="Return Serialized Result&#xa;(API response)" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="480" y="1760" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="arrow1" parent="1" source="start" target="step1" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow2" parent="1" source="step1" target="step2" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow3" parent="1" source="step2" target="step3" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow4" parent="1" source="step3" target="step4" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow5" parent="1" source="step4" target="step5" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow6" parent="1" source="step5" target="decision1" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow7a" value="NO" parent="1" source="decision1" target="step6a" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow7b" value="YES" parent="1" source="decision1" target="step6b" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow8a" parent="1" source="step6a" target="merge1" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow8b" parent="1" source="step6b" target="merge1" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow9" parent="1" source="merge1" target="execution" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow10" parent="1" source="execution" target="step7" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow11" parent="1" source="step7" target="decision2" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow12" value="YES" parent="1" source="decision2" target="step8" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow13" value="NO" parent="1" source="decision2" target="merge2" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow14" parent="1" source="step8" target="merge2" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="910" y="1300"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow15" parent="1" source="merge2" target="step9" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow16" parent="1" source="step9" target="step10" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow17" parent="1" source="step10" target="step11" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow18" parent="1" source="step11" target="step12" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow19" parent="1" source="step12" target="step13" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow20" parent="1" source="step13" target="end" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;" parent="1" vertex="1">
                    <mxGeometry x="820" y="80" width="300" height="280" as="geometry"/>
                </mxCell>
                <mxCell id="legend-title" value="LEGEND" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="870" y="90" width="200" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="legend1" value="Initialization Step" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="840" y="130" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="legend2" value="State Preparation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="980" y="130" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="legend3" value="LangGraph Execution" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="840" y="175" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="legend4" value="Memory Monitoring" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="980" y="175" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="legend5" value="Result Processing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="840" y="220" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="legend6" value="Decision Point" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="980" y="215" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="legend-note" value="Typical Execution: 5-15 seconds&#xa;Memory Growth: 50-150 MB&#xa;Phases: 6 main stages&#xa;Decision Points: 2 conditional branches" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="840" y="270" width="260" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="stats-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;" parent="1" vertex="1">
                    <mxGeometry x="820" y="390" width="300" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="stats-title" value="KEY STATISTICS" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="870" y="400" width="200" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="stats-content" value="Before Execution:&#xa;✓ 4 initialization steps&#xa;✓ Checkpointer setup&#xa;✓ State detection and preparation&#xa;&#xa;During Execution:&#xa;✓ 17 workflow nodes&#xa;✓ Parallel retrieval&#xa;✓ Iterative SQL generation&#xa;&#xa;After Execution:&#xa;✓ Memory monitoring (2 stages)&#xa;✓ Result extraction (3 steps)&#xa;✓ Final cleanup and logging" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacing=4;" parent="1" vertex="1">
                    <mxGeometry x="830" y="440" width="280" height="140" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>